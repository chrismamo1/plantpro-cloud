before_script:
 - echo "@edge http://dl-cdn.alpinelinux.org/alpine/edge/community/" >> /etc/apk/repositories
 - cat /etc/apk/repositories
 - apk update
 - apk add make m4 ocaml perl build-base gcc zlib-dev opam patch sqlite-dev glib-dev pkgconfig gmp-dev ncurses-dev camlp4 git bash
 - update-ca-certificates
 - export OPAMYES=true
 - comp=${1:-system}
 - opam init --comp="${comp}"
 - opam switch 4.03.0
 - eval `opam config env`
 - opam update
 - opam install camlp4
 - opam upgrade
 - ocaml -version
 - opam --version
 - camlp4 -version
 - opam install ocamlbuild cryptokit opium sqlexpr

build:
  script: "cd server && make"